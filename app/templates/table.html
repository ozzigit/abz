{% extends "base2.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}
<table id="data" class="table table-striped table-hover row-select">
    <thead>
    <tr>
        <th>Name</th>
        <th>Work position</th>
        <th>Date join</th>
        <th>Wage</th>
        <th>Chief</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>
{% endblock %}

{% block scripts %}
<script>
    let table
    $(document).ready(function () {
        table = $('#data').DataTable({
            ajax: '/api/data',
            serverSide: true,
            columns: [
                {data: 'name',},
                {data: 'work_position'},
                {data: 'date_join'},
                {data: 'wage'},
                {data: 'chief_name'}
            ],
        });
    });
    $('#data').on('click', 'tbody td', function () {
        //get textContent of the TD
        const row = table.row(this).data();
        const text_pushed = this.textContent;
        // console.log('TD cell textContent : ', this.textContent)
        // console.log('row info :', row);
        if (row.chief_name == text_pushed) {
            window.location.href = "/person/" + row.chief_id;
        } else {
            window.location.href = "/person/" + row.id;
        }
    });
</script>
{% endblock %}
